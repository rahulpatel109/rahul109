<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Dynamic Event Countdown</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f0f4f8;
      margin: 0;
      padding: 20px;
    }
    h1 {
      text-align: center;
      margin-bottom: 20px;
    }
    form {
      background: #fff;
      padding: 20px;
      border-radius: 10px;
      max-width: 500px;
      margin: auto;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    form input, form select, form textarea, form button {
      display: block;
      width: 100%;
      padding: 10px;
      margin-top: 10px;
    }
    .events {
      margin-top: 40px;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px;
    }
    .event {
      background: #fff;
      padding: 20px;
      border-radius: 10px;
      width: 300px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      position: relative;
    }
    .category {
      padding: 3px 8px;
      border-radius: 6px;
      color: #fff;
      font-size: 0.8em;
      position: absolute;
      top: 10px;
      right: 10px;
    }
    .btn-group {
      margin-top: 10px;
      display: flex;
      justify-content: space-between;
    }
    .btn-group button {
      width: 48%;
      padding: 5px;
    }
  </style>
</head>
<body>
  <h1>Multi-Event Countdown</h1>
  <form id="eventForm">
    <input type="text" id="title" placeholder="Event Title" required />
    <textarea id="description" placeholder="Description (optional)"></textarea>
    <input type="datetime-local" id="datetime" required />
    <input type="email" id="email" placeholder="Email for Reminder (optional)" />
    <select id="category">
      <option>Birthday</option>
      <option>Meeting</option>
      <option>Holiday</option>
      <option>Custom</option>
    </select>
    <button type="submit">Add Event</button>
  </form>

  <div class="events" id="eventsList"></div>

  <script>
    const form = document.getElementById('eventForm');
    const eventsList = document.getElementById('eventsList');

    let events = JSON.parse(localStorage.getItem('events')) || [];

    const categoryColors = {
      Birthday: '#ff6f61',
      Meeting: '#007bff',
      Holiday: '#28a745',
      Custom: '#6f42c1'
    };  
    function saveEvents() {
      localStorage.setItem('events', JSON.stringify(events));
    }
    function renderEvents() {
      eventsList.innerHTML = '';
      events.forEach((event, index) => {
        const now = new Date();
        const eventDate = new Date(event.datetime);
        const diff = eventDate - now;
        let countdown = '';

        if (diff <= 0) {
          countdown = `ðŸŽ‰ ${event.title} is happening now!`;
        } else {
          const days = Math.floor(diff / (1000 * 60 * 60 * 24));
          const hours = Math.floor((diff / (1000 * 60 * 60)) % 24);
          const minutes = Math.floor((diff / 1000 / 60) % 60);
          const seconds = Math.floor((diff / 1000) % 60);
          countdown = `${days}d ${hours}h ${minutes}m ${seconds}s`;

          // Simulate reminder 1 day before
          if (event.email && !event.reminded && diff < 86400000) {
            console.log(`Reminder: '${event.title}' is happening tomorrow. Email sent to: ${event.email}`);
            alert(`Reminder sent to ${event.email} for event: ${event.title}`);
            event.reminded = true;
            saveEvents();
          }
        }

        const div = document.createElement('div');
        div.className = 'event';
        div.innerHTML = `
          <div class="category" style="background:${categoryColors[event.category] || '#333'}">
            ${event.category}
          </div>
          <h3>${event.title}</h3>
          <p>${event.description || ''}</p>
          <p><strong>Time Left:</strong> ${countdown}</p>
          ${event.email ? `<p><small>Reminder to: ${event.email}</small></p>` : ''}
          <div class="btn-group">
            <button onclick="deleteEvent(${index})">Delete</button>
            <button onclick="editEvent(${index})">Edit</button>
          </div>
        `;
        eventsList.appendChild(div);
      });
    }

    function deleteEvent(index) {
      if (confirm('Are you sure you want to delete this event?')) {
        events.splice(index, 1);
        saveEvents();
        renderEvents();
      }
    }

    function editEvent(index) {
      const event = events[index];
      document.getElementById('title').value = event.title;
      document.getElementById('description').value = event.description;
      document.getElementById('datetime').value = event.datetime;
      document.getElementById('email').value = event.email || '';
      document.getElementById('category').value = event.category;
      events.splice(index, 1);
      saveEvents();
      renderEvents();
    }

    form.addEventListener('submit', e => {
      e.preventDefault();
      const title = document.getElementById('title').value.trim();
      const description = document.getElementById('description').value.trim();
      const datetime = document.getElementById('datetime').value;
      const email = document.getElementById('email').value.trim();
      const category = document.getElementById('category').value;

      if (!title || !datetime) return alert('Please fill in required fields.');
      if (new Date(datetime) <= new Date()) return alert('Event time must be in the future.');

      events.push({ title, description, datetime, email, category, reminded: false });
      saveEvents();
      form.reset();
      renderEvents();
    });

    // Countdown updater
    setInterval(renderEvents, 1000);
    renderEvents();
  </script>
</body>
</html> 